<!DOCTYPE html>
<html lang="en" ng-app="cricketApp">
<head>
  <meta charset="UTF-8" />
  <title>Cricket Scoring</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="css/style.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    body {
      background-color: #f8f9fa;
    }
    .scoreboard {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px #ccc;
      margin-top: 20px;
    }
    .btn-score {
      min-width: 60px;
      margin-bottom: 10px;
    }
    .over-display {
      font-family: monospace;
    }
  </style>
</head>
<body ng-controller="ScoringController as ctrl">
  <div class="container">
    <h2 class="text-center mt-3">Live Match: {{ ctrl.match.teamA }} vs {{ ctrl.match.teamB }}</h2>

    <div class="scoreboard mt-4">
      <h4>Score: {{ ctrl.totalRuns }} / {{ ctrl.wickets }}</h4>
      <p>Overs: {{ ctrl.oversBowled }} / {{ ctrl.totalOvers }}</p>
      <p>Current Over: <span class="over-display">[ {{ ctrl.currentOver.join(", ") }} ]</span></p>

      <hr />
      <div class="row">
        <div class="col-6">
          <p>Striker: <strong>{{ ctrl.striker }}<span ng-if="ctrl.onStrike === 'striker'">*</span></strong></p>
          <p>Non-Striker: <strong>{{ ctrl.nonStriker }}<span ng-if="ctrl.onStrike === 'nonStriker'">*</span></strong></p>
        </div>
        <div class="col-6 text-end">
          <p>Bowler: <strong>{{ ctrl.bowler }}</strong></p>
          <p>Economy: {{ ctrl.economy | number:2 }}</p>
        </div>
      </div>

      <hr />
      <div class="text-center">
        <h5>Enter Ball Outcome</h5>
        <div class="btn-group flex-wrap">
          <button class="btn btn-secondary btn-score" ng-click="ctrl.addScore(0)">0</button>
          <button class="btn btn-primary btn-score" ng-click="ctrl.addScore(1)">1</button>
          <button class="btn btn-primary btn-score" ng-click="ctrl.addScore(2)">2</button>
          <button class="btn btn-primary btn-score" ng-click="ctrl.addScore(3)">3</button>
          <button class="btn btn-success btn-score" ng-click="ctrl.addScore(4)">4</button>
          <button class="btn btn-success btn-score" ng-click="ctrl.addScore(5)">5</button>
          <button class="btn btn-success btn-score" ng-click="ctrl.addScore(6)">6</button>
          <button class="btn btn-warning btn-score" ng-click="ctrl.addExtra('wd')">wd</button>
          <button class="btn btn-warning btn-score" ng-click="ctrl.addExtra('nb')">nb</button>
          <button class="btn btn-danger btn-score" ng-click="ctrl.recordWicket()">Wk</button>
          <button class="btn btn-dark btn-score" ng-click="ctrl.undo()">Undo</button>
        </div>
        <div class="mt-3">
          <button class="btn btn-outline-info me-2" ng-click="ctrl.endOver()">End Over</button>
          <button class="btn btn-outline-danger" ng-click="ctrl.confirmEndInnings()">End Innings</button>
        </div>
      </div>
    </div>
  </div>

  <!-- End Innings Confirmation -->
  <div class="modal fade" id="endInningsModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">End First Innings</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to end the first innings?</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-danger" ng-click="ctrl.endInnings()">Yes, End Innings</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap + Angular -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>

  <!-- Game JS Hooks (next steps) -->
  <script src="assets/js/game_state.js"></script>
  <script src="assets/js/scoring_logic.js"></script>
  <script src="assets/js/ui_manager.js"></script>
  <script src="assets/js/summary_generator.js"></script>
  <script src="assets/js/pdf-export.js"></script>

  <!-- Main App Logic -->
  <script src="assets/js/app.js"></script>

  <nav class="nav-footer d-flex justify-content-around py-2">
    <a href="index.html" class="text-dark text-decoration-none text-center">
      <div>üè†<br><small>Home</small></div>
    </a>
    <a href="scoring.html" class="text-dark text-decoration-none text-center">
      <div>‚úçÔ∏è<br><small>Score</small></div>
    </a>
    <a href="match_history.html" class="text-dark text-decoration-none text-center">
      <div>üìú<br><small>History</small></div>
    </a>
    <a href="match_summary.html" class="text-dark text-decoration-none text-center">
      <div>üìä<br><small>Summary</small></div>
    </a>
  </nav>

  <!-- Next Bowler Modal -->
  <div class="modal fade" id="nextBowlerModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content p-3">
        <h5>New Bowler</h5>
        <input type="text" id="newBowlerName" class="form-control" placeholder="Enter new bowler name" />
        <div class="text-end mt-3">
          <button class="btn btn-primary" onclick="uiManager.confirmNextBowler()">Confirm</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Wicket Modal -->
  <div class="modal fade" id="wicketModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content p-3">
        <h5>Wicket Details</h5>
        <label class="form-label">Who got out?</label>
        <div>
          <input type="radio" name="outPlayer" value="striker" checked /> Striker<br />
          <input type="radio" name="outPlayer" value="nonStriker" /> Non-Striker
        </div>
        <input type="text" id="nextBatsmanName" class="form-control mt-3" placeholder="Next batsman name" />
        <div class="text-end mt-3">
          <button class="btn btn-danger" onclick="uiManager.confirmWicket()">Continue</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Insert here -->
<div class="modal fade" id="nextBowlerModal" ...>...</div>
<div class="modal fade" id="wicketModal" ...>...</div>
<!-- End -->
<div id="teamScore">0/0</div>
<div id="oversBowled">0.0</div>
<div id="strikerInfo">-</div>
<div id="nonStrikerInfo">-</div>
<div id="bowlerInfo">-</div>
<div id="thisOverEvents" class="d-flex flex-wrap"></div>
</body>
</html>